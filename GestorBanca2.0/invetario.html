<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventário</title>
    <style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
    }

    h1 {
        text-align: center;
        color: #333;
        margin: 20px 0;
    }

    .produtos {
        max-width: 600px;
        margin: 0 auto;
        padding: 10px;
    }

    .linha {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: white;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .produto {
        flex: 1;
    }

    .produtoNome {
        font-size: 18px;
        margin: 0;
        color: #555;
    }

    .precoCaixa {
        font-size: 16px;
        color: #777;
    }

    .editar button {
        background-color: #007bff;
        border: none;
        color: white;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
    }

    .editar button:hover {
        background-color: #0056b3;
    }

    .add-button {
        display: block;
        background-color: #28a745;
        border: none;
        color: white;
        padding: 15px;
        width: 100%;
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        font-size: 16px;
        margin-top: 20px;
    }

    .add-button:hover {
        background-color: #218838;
    }

    @media (max-width: 600px) {
        .linha {
            flex-direction: column;
            text-align: center;
        }

        .editar {
            margin-top: 10px;
        }

        .produtoNome {
            font-size: 16px;
        }

        .precoCaixa {
            font-size: 14px;
        }

        .editar button {
            width: 100%;
        }
    }
</style>
</head>
<body>
    <h1>Inventário</h1>
    
    <div id="produtos" class="produtos"></div>

    <button class="add-button" id="adicionarButton" disabled>Adicionar ao Inventário</button>

    <script>
        const sheetURL = 'https://docs.google.com/spreadsheets/d/126_nvJJ6-QfKP93g3VHolu7TWhMX6MM5HMRek6jRnxE/gviz/tq?tqx=out:json'; // URL da sua planilha do Google Sheets
        
        let produtoSelecionado = null;
        
        async function carregarProdutos() {
            const response = await fetch(sheetURL);
            const dataText = await response.text();
            const jsonData = JSON.parse(dataText.substring(47).slice(0, -2));
            const rows = jsonData.table.rows;

            const produtosDiv = document.getElementById('produtos');

            rows.forEach((row) => {
                const nomeProduto = row.c[0].v;
                const precoCaixa = row.c[2].v;
                const quantidadeAtual = row.c[4]?.v || 0; // Quantidade atual na planilha
                const quantidadePorCaixa = row.c[5]?.v || 0; // Quantidade na caixa

                const linha = document.createElement('div');
                linha.className = 'linha';
                linha.innerHTML = `
                    <div class="produto">
                        <h3 class="produtoNome">${nomeProduto}</h3>
                        <p class="precoCaixa">${precoCaixa}MT Caixa</p>
                    </div>
                    <div class="editar">
                        <button>Editar</button>
                    </div>
                `;
                
                linha.onclick = () => selecionarProduto({
                    nome: nomeProduto,
                    quantidadeAtual: quantidadeAtual,
                    quantidadePorCaixa: quantidadePorCaixa
                });

                produtosDiv.appendChild(linha);
            });
        }

        function selecionarProduto(produto) {
            produtoSelecionado = produto;
            document.getElementById('adicionarButton').disabled = false;
            console.log("Produto selecionado:", produtoSelecionado);
        }

        document.getElementById('adicionarButton').onclick = async function() {
            if (produtoSelecionado) {
                // Cálculo da nova quantidade
                const novaQuantidade = produtoSelecionado.quantidadeAtual + produtoSelecionado.quantidadePorCaixa;
                
                // Função para atualizar a quantidade no Google Sheets (API do Google Sheets necessária)
                await atualizarQuantidadeNoSheets(produtoSelecionado.nome, novaQuantidade);

                alert(`Produto ${produtoSelecionado.nome} atualizado para ${novaQuantidade}`);
            }
        };

        async function atualizarQuantidadeNoSheets(nomeProduto, novaQuantidade) {
            // Aqui você precisa integrar com a API do Google Sheets
            // Isso normalmente requer uma API key e o uso do Google Apps Script ou OAuth
            console.log(`Atualizando ${nomeProduto} para ${novaQuantidade} na planilha...`);
            // Exemplo de código de integração com API (omiti o código exato para a API)
        }

        carregarProdutos();
    </script>
</body>
</html>
